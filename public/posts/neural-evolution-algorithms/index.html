<!doctype html>
<html
  lang="en-us"
  dir="ltr"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=60088&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<link
  href="https://fonts.googleapis.com/css2?family=Mulish:wght@200;300;400;500;600;700;800;900&display=swap"
  rel="stylesheet"
/>






<link
  rel="icon"
  type="image/svg+xml"
  href="/favicon/favicon.svg"
  media="(prefers-color-scheme: light)"
/>
<link
  rel="icon"
  type="image/svg+xml"
  href="/favicon-dark/favicon.svg"
  media="(prefers-color-scheme: dark)"
/>

<link
  rel="icon"
  type="image/png"
  href="/favicon/favicon-96x96.png"
  sizes="96x96"
  media="(prefers-color-scheme: light)"
/>
<link
  rel="icon"
  type="image/png"
  href="/favicon-dark/favicon-96x96.png"
  sizes="96x96"
  media="(prefers-color-scheme: dark)"
/>

<link
  rel="icon"
  type="image/x-icon"
  href="/favicon/favicon.ico"
  media="(prefers-color-scheme: light)"
/>
<link
  rel="icon"
  type="image/x-icon"
  href="/favicon-dark/favicon.ico"
  media="(prefers-color-scheme: dark)"
/>
<title>
  
    Evolutionary Neural Networks: Training AI Through Natural Selection | while(True):
  
</title>

  <link rel="stylesheet" href="/css/bundle.css" />



  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    },
    loader:{
      load: ['ui/safe']
    },
  };
</script>



  </head>
  <body>
    <header>
      <nav class="navbar">
  <div class="glider-container">
    <div class="glider">
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>
  </div>
  <h1 class="site-title">
    <a href="http://localhost:60088/" class="site-title-link">while(<span class="true">True</span>):</a>
  </h1>
  <div class="spacer"></div>
  <ul>
      <li>
        <a
          href="/"
          class="brackets "
          
        >
          Home
        </a>
      </li>
      <li>
        <a
          href="/about/"
          class="brackets "
          
        >
          About
        </a>
      </li>
  </ul>
</nav>

    </header>
    <main class="main">
      
  
  

  <article class="post">

    <header class="post-header">
      <h1 class="post-title">Evolutionary Neural Networks: Training AI Through Natural Selection</h1>
      <time datetime="2023-04-15T10:00:00-07:00">April 15, 2023</time>
    </header>

    <div class="post-content">
    <p>Evolutionary algorithms provide a fascinating alternative to traditional gradient-based training methods for neural networks. By mimicking the process of natural selection, these algorithms can discover novel solutions to complex problems that might be difficult to find through conventional optimization techniques.</p>
<h2 id="the-problem-with-gradient-based-learning">
  <a href="#the-problem-with-gradient-based-learning" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  The Problem with Gradient-Based Learning
</h2>
<p>Traditional neural network training relies on backpropagation and gradient descent. While effective for many problems, this approach has several limitations:</p>
<ol>
<li><strong>Local Optima</strong>: Gradient descent can get stuck in local minima</li>
<li><strong>Gradient Vanishing/Exploding</strong>: Deep networks often suffer from gradient problems</li>
<li><strong>Discrete Actions</strong>: Difficult to handle discrete decision-making problems</li>
<li><strong>Credit Assignment</strong>: Hard to assign credit in long sequences of actions</li>
</ol>
<p>Evolutionary algorithms offer a different approach that can overcome these limitations.</p>
<h2 id="how-evolutionary-algorithms-work">
  <a href="#how-evolutionary-algorithms-work" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  How Evolutionary Algorithms Work
</h2>
<p>Evolutionary algorithms simulate the process of natural selection:</p>
<ol>
<li><strong>Population</strong>: Start with a population of candidate solutions</li>
<li><strong>Fitness Evaluation</strong>: Evaluate how well each solution performs</li>
<li><strong>Selection</strong>: Choose the best solutions to reproduce</li>
<li><strong>Crossover</strong>: Combine features from parent solutions</li>
<li><strong>Mutation</strong>: Introduce random changes to maintain diversity</li>
<li><strong>Replacement</strong>: Replace the population with the new generation</li>
</ol>
<h2 id="neuroevolution-evolving-neural-networks">
  <a href="#neuroevolution-evolving-neural-networks" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Neuroevolution: Evolving Neural Networks
</h2>
<p>Neuroevolution applies evolutionary algorithms specifically to neural networks. Here&rsquo;s a basic implementation:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1</span><span><span style="color:#c678dd">import</span> <span style="color:#e06c75">numpy</span> <span style="color:#c678dd">as</span> <span style="color:#e06c75">np</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2</span><span><span style="color:#c678dd">import</span> <span style="color:#e06c75">random</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">NeuralNetwork</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">input_size</span>, <span style="color:#e06c75">hidden_size</span>, <span style="color:#e06c75">output_size</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">input_size</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">input_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">hidden_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">output_size</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">output_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10</span><span>        <span style="color:#7f848e"># Initialize weights randomly</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights1</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">randn</span>(<span style="color:#e06c75">input_size</span>, <span style="color:#e06c75">hidden_size</span>) <span style="color:#56b6c2">*</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">randn</span>(<span style="color:#e06c75">hidden_size</span>, <span style="color:#e06c75">output_size</span>) <span style="color:#56b6c2">*</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias1</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">randn</span>(<span style="color:#e06c75">hidden_size</span>) <span style="color:#56b6c2">*</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">randn</span>(<span style="color:#e06c75">output_size</span>) <span style="color:#56b6c2">*</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">forward</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">inputs</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17</span><span>        <span style="color:#7f848e"># Forward propagation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18</span><span>        <span style="color:#e06c75">hidden</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">tanh</span>(<span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">dot</span>(<span style="color:#e06c75">inputs</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights1</span>) <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19</span><span>        <span style="color:#e06c75">output</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">tanh</span>(<span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">dot</span>(<span style="color:#e06c75">hidden</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights2</span>) <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">output</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">get_weights</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23</span><span>        <span style="color:#7f848e"># Flatten all weights and biases into a single array</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">concatenate</span>([
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25</span><span>            <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights1</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">flatten</span>(),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26</span><span>            <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights2</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">flatten</span>(),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27</span><span>            <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias1</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">flatten</span>(),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28</span><span>            <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias2</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">flatten</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29</span><span>        ])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">set_weights</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">weights</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32</span><span>        <span style="color:#7f848e"># Reconstruct weights and biases from flattened array</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33</span><span>        <span style="color:#e06c75">start</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35</span><span>        <span style="color:#7f848e"># Reconstruct weights1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36</span><span>        <span style="color:#e06c75">end</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">start</span> <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">input_size</span> <span style="color:#56b6c2">*</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights1</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">weights</span>[<span style="color:#e06c75">start</span>:<span style="color:#e06c75">end</span>]<span style="color:#56b6c2">.</span><span style="color:#e06c75">reshape</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">input_size</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38</span><span>        <span style="color:#e06c75">start</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40</span><span>        <span style="color:#7f848e"># Reconstruct weights2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41</span><span>        <span style="color:#e06c75">end</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">start</span> <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span> <span style="color:#56b6c2">*</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">output_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weights2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">weights</span>[<span style="color:#e06c75">start</span>:<span style="color:#e06c75">end</span>]<span style="color:#56b6c2">.</span><span style="color:#e06c75">reshape</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">output_size</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43</span><span>        <span style="color:#e06c75">start</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">44</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">45</span><span>        <span style="color:#7f848e"># Reconstruct bias1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">46</span><span>        <span style="color:#e06c75">end</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">start</span> <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">hidden_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">47</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias1</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">weights</span>[<span style="color:#e06c75">start</span>:<span style="color:#e06c75">end</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">48</span><span>        <span style="color:#e06c75">start</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">49</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">50</span><span>        <span style="color:#7f848e"># Reconstruct bias2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">51</span><span>        <span style="color:#e06c75">end</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">start</span> <span style="color:#56b6c2">+</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">output_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">52</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">bias2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">weights</span>[<span style="color:#e06c75">start</span>:<span style="color:#e06c75">end</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">53</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">54</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">EvolutionaryAlgorithm</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">55</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">population_size</span>, <span style="color:#e06c75">mutation_rate</span>, <span style="color:#e06c75">mutation_strength</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">56</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">population_size</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">population_size</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">57</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">mutation_rate</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">mutation_rate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">58</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">mutation_strength</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">mutation_strength</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">59</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">60</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">mutate</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">individual</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">61</span><span>        <span style="color:#7f848e"># Add random noise to weights</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">62</span><span>        <span style="color:#e06c75">mutation</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">normal</span>(<span style="color:#d19a66">0</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">mutation_strength</span>, <span style="color:#e06c75">individual</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">shape</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">63</span><span>        <span style="color:#e06c75">mask</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span>(<span style="color:#e06c75">individual</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">shape</span>) <span style="color:#56b6c2">&lt;</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">mutation_rate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">64</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">individual</span> <span style="color:#56b6c2">+</span> <span style="color:#e06c75">mutation</span> <span style="color:#56b6c2">*</span> <span style="color:#e06c75">mask</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">65</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">66</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">crossover</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">parent1</span>, <span style="color:#e06c75">parent2</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">67</span><span>        <span style="color:#7f848e"># Uniform crossover</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">68</span><span>        <span style="color:#e06c75">mask</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span>(<span style="color:#e06c75">parent1</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">shape</span>) <span style="color:#56b6c2">&lt;</span> <span style="color:#d19a66">0.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">69</span><span>        <span style="color:#e06c75">child</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">where</span>(<span style="color:#e06c75">mask</span>, <span style="color:#e06c75">parent1</span>, <span style="color:#e06c75">parent2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">70</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">child</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">71</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">72</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">select_parents</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">population</span>, <span style="color:#e06c75">fitness_scores</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">73</span><span>        <span style="color:#7f848e"># Tournament selection</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">74</span><span>        <span style="color:#e06c75">tournament_size</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">75</span><span>        <span style="color:#e06c75">selected</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">76</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">77</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">_</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#d19a66">2</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">78</span><span>            <span style="color:#e06c75">tournament_indices</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">choice</span>(<span style="color:#e5c07b">len</span>(<span style="color:#e06c75">population</span>), <span style="color:#e06c75">tournament_size</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">79</span><span>            <span style="color:#e06c75">tournament_fitness</span> <span style="color:#56b6c2">=</span> [<span style="color:#e06c75">fitness_scores</span>[<span style="color:#e06c75">i</span>] <span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">in</span> <span style="color:#e06c75">tournament_indices</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">80</span><span>            <span style="color:#e06c75">winner_idx</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">tournament_indices</span>[<span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">argmax</span>(<span style="color:#e06c75">tournament_fitness</span>)]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">81</span><span>            <span style="color:#e06c75">selected</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">population</span>[<span style="color:#e06c75">winner_idx</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">82</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">83</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">selected</span>[<span style="color:#d19a66">0</span>], <span style="color:#e06c75">selected</span>[<span style="color:#d19a66">1</span>]
</span></span></code></pre></div><h2 id="example-evolving-a-simple-agent">
  <a href="#example-evolving-a-simple-agent" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Example: Evolving a Simple Agent
</h2>
<p>Let&rsquo;s create a simple example where we evolve a neural network to solve a basic navigation problem:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  1</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">SimpleEnvironment</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  2</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  3</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">reset</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  4</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  5</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">reset</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  6</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">agent_pos</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">array</span>([<span style="color:#d19a66">0.0</span>, <span style="color:#d19a66">0.0</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  7</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">target_pos</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">array</span>([<span style="color:#d19a66">1.0</span>, <span style="color:#d19a66">1.0</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  8</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">steps</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  9</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">max_steps</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">100</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 10</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 11</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">step</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">action</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 12</span><span>        <span style="color:#7f848e"># Action is a 2D vector representing movement</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 13</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">agent_pos</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">action</span> <span style="color:#56b6c2">*</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 14</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">steps</span> <span style="color:#56b6c2">+=</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 15</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 16</span><span>        <span style="color:#7f848e"># Calculate distance to target</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 17</span><span>        <span style="color:#e06c75">distance</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">linalg</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">norm</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">agent_pos</span> <span style="color:#56b6c2">-</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">target_pos</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 18</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 19</span><span>        <span style="color:#7f848e"># Reward is negative distance (closer is better)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 20</span><span>        <span style="color:#e06c75">reward</span> <span style="color:#56b6c2">=</span> <span style="color:#56b6c2">-</span><span style="color:#e06c75">distance</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 21</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 22</span><span>        <span style="color:#7f848e"># Episode ends if agent reaches target or max steps</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 23</span><span>        <span style="color:#e06c75">done</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">distance</span> <span style="color:#56b6c2">&lt;</span> <span style="color:#d19a66">0.1</span> <span style="color:#56b6c2">or</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">steps</span> <span style="color:#56b6c2">&gt;=</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">max_steps</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 24</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 25</span><span>        <span style="color:#7f848e"># State is agent position and target position</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 26</span><span>        <span style="color:#e06c75">state</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">concatenate</span>([<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">agent_pos</span>, <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">target_pos</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 27</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 28</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">state</span>, <span style="color:#e06c75">reward</span>, <span style="color:#e06c75">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 30</span><span><span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">evaluate_fitness</span>(<span style="color:#e06c75">network</span>, <span style="color:#e06c75">env</span>, <span style="color:#e06c75">episodes</span><span style="color:#56b6c2">=</span><span style="color:#d19a66">5</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 31</span><span>    <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 32</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 33</span><span>    <span style="color:#c678dd">for</span> <span style="color:#e06c75">_</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#e06c75">episodes</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 34</span><span>        <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">reset</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 35</span><span>        <span style="color:#e06c75">episode_reward</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 36</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 37</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">step</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">max_steps</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 38</span><span>            <span style="color:#e06c75">state</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">concatenate</span>([<span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">agent_pos</span>, <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">target_pos</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 39</span><span>            <span style="color:#e06c75">action</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">network</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">forward</span>(<span style="color:#e06c75">state</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 40</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 41</span><span>            <span style="color:#7f848e"># Clip action to reasonable range</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 42</span><span>            <span style="color:#e06c75">action</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">clip</span>(<span style="color:#e06c75">action</span>, <span style="color:#56b6c2">-</span><span style="color:#d19a66">1</span>, <span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 43</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 44</span><span>            <span style="color:#e06c75">state</span>, <span style="color:#e06c75">reward</span>, <span style="color:#e06c75">done</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">step</span>(<span style="color:#e06c75">action</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 45</span><span>            <span style="color:#e06c75">episode_reward</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 46</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 47</span><span>            <span style="color:#c678dd">if</span> <span style="color:#e06c75">done</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 48</span><span>                <span style="color:#c678dd">break</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 49</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 50</span><span>        <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">episode_reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 51</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 52</span><span>    <span style="color:#c678dd">return</span> <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">/</span> <span style="color:#e06c75">episodes</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 53</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 54</span><span><span style="color:#7f848e"># Training loop</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 55</span><span><span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">train_evolutionary</span>():
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 56</span><span>    <span style="color:#e06c75">population_size</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">50</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 57</span><span>    <span style="color:#e06c75">generations</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">100</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 58</span><span>    <span style="color:#e06c75">mutation_rate</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 59</span><span>    <span style="color:#e06c75">mutation_strength</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0.1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 60</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 61</span><span>    <span style="color:#7f848e"># Initialize population</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 62</span><span>    <span style="color:#e06c75">population</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 63</span><span>    <span style="color:#c678dd">for</span> <span style="color:#e06c75">_</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#e06c75">population_size</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 64</span><span>        <span style="color:#e06c75">network</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NeuralNetwork</span>(<span style="color:#d19a66">4</span>, <span style="color:#d19a66">8</span>, <span style="color:#d19a66">2</span>)  <span style="color:#7f848e"># 4 inputs, 8 hidden, 2 outputs</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 65</span><span>        <span style="color:#e06c75">population</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">network</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">get_weights</span>())
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 66</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 67</span><span>    <span style="color:#e06c75">env</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">SimpleEnvironment</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 68</span><span>    <span style="color:#e06c75">ea</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">EvolutionaryAlgorithm</span>(<span style="color:#e06c75">population_size</span>, <span style="color:#e06c75">mutation_rate</span>, <span style="color:#e06c75">mutation_strength</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 69</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 70</span><span>    <span style="color:#e06c75">best_fitness_history</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 71</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 72</span><span>    <span style="color:#c678dd">for</span> <span style="color:#e06c75">generation</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#e06c75">generations</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 73</span><span>        <span style="color:#7f848e"># Evaluate fitness for all individuals</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 74</span><span>        <span style="color:#e06c75">fitness_scores</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 75</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">individual</span> <span style="color:#56b6c2">in</span> <span style="color:#e06c75">population</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 76</span><span>            <span style="color:#e06c75">network</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NeuralNetwork</span>(<span style="color:#d19a66">4</span>, <span style="color:#d19a66">8</span>, <span style="color:#d19a66">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 77</span><span>            <span style="color:#e06c75">network</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">set_weights</span>(<span style="color:#e06c75">individual</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 78</span><span>            <span style="color:#e06c75">fitness</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">evaluate_fitness</span>(<span style="color:#e06c75">network</span>, <span style="color:#e06c75">env</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 79</span><span>            <span style="color:#e06c75">fitness_scores</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">fitness</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 80</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 81</span><span>        <span style="color:#7f848e"># Track best fitness</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 82</span><span>        <span style="color:#e06c75">best_fitness</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">max</span>(<span style="color:#e06c75">fitness_scores</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 83</span><span>        <span style="color:#e06c75">best_fitness_history</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">best_fitness</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 84</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 85</span><span>        <span style="color:#e5c07b">print</span>(<span style="color:#98c379">f</span><span style="color:#98c379">&#34;Generation </span><span style="color:#98c379">{</span><span style="color:#e06c75">generation</span><span style="color:#98c379">}</span><span style="color:#98c379">: Best fitness = </span><span style="color:#98c379">{</span><span style="color:#e06c75">best_fitness</span><span style="color:#98c379">:</span><span style="color:#98c379">.3f</span><span style="color:#98c379">}</span><span style="color:#98c379">&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 86</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 87</span><span>        <span style="color:#7f848e"># Create new population</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 88</span><span>        <span style="color:#e06c75">new_population</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 89</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 90</span><span>        <span style="color:#7f848e"># Elitism: keep the best individual</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 91</span><span>        <span style="color:#e06c75">best_idx</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">argmax</span>(<span style="color:#e06c75">fitness_scores</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 92</span><span>        <span style="color:#e06c75">new_population</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">population</span>[<span style="color:#e06c75">best_idx</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 93</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 94</span><span>        <span style="color:#7f848e"># Generate rest of population through selection, crossover, and mutation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 95</span><span>        <span style="color:#c678dd">while</span> <span style="color:#e5c07b">len</span>(<span style="color:#e06c75">new_population</span>) <span style="color:#56b6c2">&lt;</span> <span style="color:#e06c75">population_size</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 96</span><span>            <span style="color:#e06c75">parent1</span>, <span style="color:#e06c75">parent2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">ea</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">select_parents</span>(<span style="color:#e06c75">population</span>, <span style="color:#e06c75">fitness_scores</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 97</span><span>            <span style="color:#e06c75">child</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">ea</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">crossover</span>(<span style="color:#e06c75">parent1</span>, <span style="color:#e06c75">parent2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 98</span><span>            <span style="color:#e06c75">child</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">ea</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">mutate</span>(<span style="color:#e06c75">child</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 99</span><span>            <span style="color:#e06c75">new_population</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">append</span>(<span style="color:#e06c75">child</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">100</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">101</span><span>        <span style="color:#e06c75">population</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">new_population</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">102</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">103</span><span>    <span style="color:#c678dd">return</span> <span style="color:#e06c75">best_fitness_history</span>
</span></span></code></pre></div><h2 id="advanced-neuroevolution-techniques">
  <a href="#advanced-neuroevolution-techniques" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Advanced Neuroevolution Techniques
</h2>
<h3 id="neat-neuroevolution-of-augmenting-topologies">
  <a href="#neat-neuroevolution-of-augmenting-topologies" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  NEAT (NeuroEvolution of Augmenting Topologies)
</h3>
<p>NEAT is a more sophisticated approach that evolves both the topology and weights of neural networks:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">NEATNode</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">node_id</span>, <span style="color:#e06c75">node_type</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">node_id</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">node_id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">node_type</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">node_type</span>  <span style="color:#7f848e"># &#39;input&#39;, &#39;hidden&#39;, &#39;output&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">activation</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">incoming_connections</span> <span style="color:#56b6c2">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">activate</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9</span><span>        <span style="color:#c678dd">if</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">node_type</span> <span style="color:#56b6c2">==</span> <span style="color:#98c379">&#39;input&#39;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10</span><span>            <span style="color:#c678dd">return</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">activation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12</span><span>        <span style="color:#7f848e"># Sum incoming connections</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13</span><span>        <span style="color:#e06c75">total</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">connection</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">incoming_connections</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15</span><span>            <span style="color:#c678dd">if</span> <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">enabled</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16</span><span>                <span style="color:#e06c75">total</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weight</span> <span style="color:#56b6c2">*</span> <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">from_node</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">activation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18</span><span>        <span style="color:#7f848e"># Apply activation function (tanh)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">activation</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">tanh</span>(<span style="color:#e06c75">total</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20</span><span>        <span style="color:#c678dd">return</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">activation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">NEATConnection</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">from_node</span>, <span style="color:#e06c75">to_node</span>, <span style="color:#e06c75">weight</span>, <span style="color:#e06c75">innovation_number</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">from_node</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">from_node</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">to_node</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">to_node</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weight</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">weight</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">enabled</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">True</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">innovation_number</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">innovation_number</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30</span><span><span style="color:#c678dd">class</span> <span style="color:#e5c07b">NEATGenome</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31</span><span>    <span style="color:#c678dd">def</span> <span style="color:#56b6c2;font-weight:bold">__init__</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nodes</span> <span style="color:#56b6c2">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span> <span style="color:#56b6c2">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">fitness</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">add_node</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">node</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nodes</span>[<span style="color:#e06c75">node</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">node_id</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">node</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">add_connection</span>(<span style="color:#e5c07b">self</span>, <span style="color:#e06c75">connection</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span>[<span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">innovation_number</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">connection</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">mutate_add_node</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43</span><span>        <span style="color:#7f848e"># Add a new hidden node by splitting an existing connection</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">44</span><span>        <span style="color:#c678dd">if</span> <span style="color:#e5c07b">len</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span>) <span style="color:#56b6c2">==</span> <span style="color:#d19a66">0</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">45</span><span>            <span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">46</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">47</span><span>        <span style="color:#7f848e"># Select random connection to split</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">48</span><span>        <span style="color:#e06c75">connection</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">choice</span>(<span style="color:#e5c07b">list</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">values</span>()))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">49</span><span>        <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">enabled</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">False</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">50</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">51</span><span>        <span style="color:#7f848e"># Create new hidden node</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">52</span><span>        <span style="color:#e06c75">new_node_id</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">max</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nodes</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">keys</span>()) <span style="color:#56b6c2">+</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">53</span><span>        <span style="color:#e06c75">new_node</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NEATNode</span>(<span style="color:#e06c75">new_node_id</span>, <span style="color:#98c379">&#39;hidden&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">54</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">add_node</span>(<span style="color:#e06c75">new_node</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">55</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">56</span><span>        <span style="color:#7f848e"># Create two new connections</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">57</span><span>        <span style="color:#e06c75">innovation1</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">max</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">keys</span>()) <span style="color:#56b6c2">+</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">58</span><span>        <span style="color:#e06c75">innovation2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">innovation1</span> <span style="color:#56b6c2">+</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">59</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">60</span><span>        <span style="color:#e06c75">conn1</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NEATConnection</span>(<span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">from_node</span>, <span style="color:#e06c75">new_node</span>, <span style="color:#d19a66">1.0</span>, <span style="color:#e06c75">innovation1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">61</span><span>        <span style="color:#e06c75">conn2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NEATConnection</span>(<span style="color:#e06c75">new_node</span>, <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">to_node</span>, <span style="color:#e06c75">connection</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">weight</span>, <span style="color:#e06c75">innovation2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">62</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">63</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">add_connection</span>(<span style="color:#e06c75">conn1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">64</span><span>        <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">add_connection</span>(<span style="color:#e06c75">conn2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">65</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">66</span><span>    <span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">mutate_add_connection</span>(<span style="color:#e5c07b">self</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">67</span><span>        <span style="color:#7f848e"># Add a new connection between two unconnected nodes</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">68</span><span>        <span style="color:#e06c75">available_nodes</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">list</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nodes</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">values</span>())
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">69</span><span>        <span style="color:#c678dd">if</span> <span style="color:#e5c07b">len</span>(<span style="color:#e06c75">available_nodes</span>) <span style="color:#56b6c2">&lt;</span> <span style="color:#d19a66">2</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">70</span><span>            <span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">71</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">72</span><span>        <span style="color:#7f848e"># Find nodes that aren&#39;t already connected</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">73</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">_</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#d19a66">20</span>):  <span style="color:#7f848e"># Try 20 times to find unconnected pair</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">74</span><span>            <span style="color:#e06c75">node1</span>, <span style="color:#e06c75">node2</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sample</span>(<span style="color:#e06c75">available_nodes</span>, <span style="color:#d19a66">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">75</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">76</span><span>            <span style="color:#7f848e"># Check if connection already exists</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">77</span><span>            <span style="color:#e06c75">connection_exists</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">False</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">78</span><span>            <span style="color:#c678dd">for</span> <span style="color:#e06c75">conn</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">values</span>():
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">79</span><span>                <span style="color:#c678dd">if</span> (<span style="color:#e06c75">conn</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">from_node</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">node1</span> <span style="color:#56b6c2">and</span> <span style="color:#e06c75">conn</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">to_node</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">node2</span>) <span style="color:#56b6c2">or</span> \
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">80</span><span>                   (<span style="color:#e06c75">conn</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">from_node</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">node2</span> <span style="color:#56b6c2">and</span> <span style="color:#e06c75">conn</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">to_node</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">node1</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">81</span><span>                    <span style="color:#e06c75">connection_exists</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">True</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">82</span><span>                    <span style="color:#c678dd">break</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">83</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">84</span><span>            <span style="color:#c678dd">if</span> <span style="color:#56b6c2">not</span> <span style="color:#e06c75">connection_exists</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">85</span><span>                <span style="color:#7f848e"># Create new connection</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">86</span><span>                <span style="color:#e06c75">innovation</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">max</span>(<span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">keys</span>()) <span style="color:#56b6c2">+</span> <span style="color:#d19a66">1</span> <span style="color:#c678dd">if</span> <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">connections</span> <span style="color:#c678dd">else</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">87</span><span>                <span style="color:#e06c75">weight</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">np</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">random</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">normal</span>(<span style="color:#d19a66">0</span>, <span style="color:#d19a66">1.0</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">88</span><span>                <span style="color:#e06c75">connection</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">NEATConnection</span>(<span style="color:#e06c75">node1</span>, <span style="color:#e06c75">node2</span>, <span style="color:#e06c75">weight</span>, <span style="color:#e06c75">innovation</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">89</span><span>                <span style="color:#e5c07b">self</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">add_connection</span>(<span style="color:#e06c75">connection</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">90</span><span>                <span style="color:#c678dd">break</span>
</span></span></code></pre></div><h2 id="applications-in-reinforcement-learning">
  <a href="#applications-in-reinforcement-learning" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Applications in Reinforcement Learning
</h2>
<p>Evolutionary algorithms are particularly well-suited for reinforcement learning problems:</p>
<h3 id="advantages-in-rl">
  <a href="#advantages-in-rl" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Advantages in RL:
</h3>
<ol>
<li><strong>No Gradient Requirements</strong>: Can work with discrete actions and non-differentiable rewards</li>
<li><strong>Exploration</strong>: Natural exploration through mutation and crossover</li>
<li><strong>Robustness</strong>: Less sensitive to reward function design</li>
<li><strong>Parallelization</strong>: Easy to evaluate multiple agents in parallel</li>
</ol>
<h3 id="example-cartpole-with-evolution">
  <a href="#example-cartpole-with-evolution" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Example: CartPole with Evolution
</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1</span><span><span style="color:#c678dd">import</span> <span style="color:#e06c75">gym</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3</span><span><span style="color:#c678dd">def</span> <span style="color:#61afef;font-weight:bold">evaluate_cartpole</span>(<span style="color:#e06c75">genome</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4</span><span>    <span style="color:#e06c75">env</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">gym</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">make</span>(<span style="color:#98c379">&#39;CartPole-v1&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5</span><span>    <span style="color:#e06c75">network</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">genome_to_network</span>(<span style="color:#e06c75">genome</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7</span><span>    <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8</span><span>    <span style="color:#c678dd">for</span> <span style="color:#e06c75">episode</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#d19a66">5</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9</span><span>        <span style="color:#e06c75">obs</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">reset</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10</span><span>        <span style="color:#e06c75">episode_reward</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12</span><span>        <span style="color:#c678dd">for</span> <span style="color:#e06c75">step</span> <span style="color:#56b6c2">in</span> <span style="color:#e5c07b">range</span>(<span style="color:#d19a66">500</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13</span><span>            <span style="color:#e06c75">action</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">network</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">forward</span>(<span style="color:#e06c75">obs</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14</span><span>            <span style="color:#e06c75">action</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">1</span> <span style="color:#c678dd">if</span> <span style="color:#e06c75">action</span>[<span style="color:#d19a66">0</span>] <span style="color:#56b6c2">&gt;</span> <span style="color:#d19a66">0</span> <span style="color:#c678dd">else</span> <span style="color:#d19a66">0</span>  <span style="color:#7f848e"># Binary action</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16</span><span>            <span style="color:#e06c75">obs</span>, <span style="color:#e06c75">reward</span>, <span style="color:#e06c75">done</span>, <span style="color:#e06c75">_</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">step</span>(<span style="color:#e06c75">action</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17</span><span>            <span style="color:#e06c75">episode_reward</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19</span><span>            <span style="color:#c678dd">if</span> <span style="color:#e06c75">done</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20</span><span>                <span style="color:#c678dd">break</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22</span><span>        <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">+=</span> <span style="color:#e06c75">episode_reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23</span><span>        <span style="color:#e06c75">env</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">close</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25</span><span>    <span style="color:#c678dd">return</span> <span style="color:#e06c75">total_reward</span> <span style="color:#56b6c2">/</span> <span style="color:#d19a66">5</span>
</span></span></code></pre></div><h2 id="challenges-and-limitations">
  <a href="#challenges-and-limitations" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Challenges and Limitations
</h2>
<p>While evolutionary algorithms offer many advantages, they also have limitations:</p>
<ol>
<li><strong>Computational Cost</strong>: Require many fitness evaluations</li>
<li><strong>Parameter Tuning</strong>: Sensitive to mutation rates and population sizes</li>
<li><strong>Scalability</strong>: May not scale well to very large networks</li>
<li><strong>Convergence</strong>: Can be slower to converge than gradient methods</li>
</ol>
<h2 id="hybrid-approaches">
  <a href="#hybrid-approaches" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Hybrid Approaches
</h2>
<p>Modern research often combines evolutionary algorithms with traditional methods:</p>
<ul>
<li><strong>Evolution Strategies</strong>: Use evolution to optimize policy gradients</li>
<li><strong>Population-Based Training</strong>: Evolve hyperparameters during training</li>
<li><strong>Meta-Learning</strong>: Use evolution to discover learning algorithms</li>
</ul>
<h2 id="future-directions">
  <a href="#future-directions" class="heading-anchor" aria-hidden="true" style="text-decoration: none; color: #999;">#</a>
  Future Directions
</h2>
<p>The field of evolutionary neural networks continues to evolve:</p>
<ol>
<li><strong>Multi-Objective Evolution</strong>: Optimizing multiple objectives simultaneously</li>
<li><strong>Coevolution</strong>: Evolving multiple populations that interact</li>
<li><strong>Modular Evolution</strong>: Evolving reusable neural network modules</li>
<li><strong>Hardware Evolution</strong>: Evolving networks specifically for neuromorphic hardware</li>
</ol>
<p>Evolutionary algorithms provide a powerful alternative to traditional neural network training methods. By embracing the principles of natural selection, they can discover novel solutions to complex problems and offer unique advantages in certain domains, particularly in reinforcement learning and optimization problems where gradient-based methods struggle.</p>
<p>The combination of evolutionary algorithms with neural networks opens up exciting possibilities for AI research and applications, from game playing to robotics to automated design systems.</p>

    </div>

  </article>


    </main>
    <footer>
      <hr />
<div class="footer-content">
  <span>&copy 2023 - 2025 Lapo Frati</span>
  
    <a href="http://localhost:60088/index.xml" class="rss-link" title="RSS Feed">
      RSS Feed
      <img src="/RSS-icon.svg" alt="RSS" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="vertical-align: middle; margin-left: 6px;">
    </a>
  
</div>

    </footer>
    
      <script src="/js/main.js"></script>

  </body>
</html>
